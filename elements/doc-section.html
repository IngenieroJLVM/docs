<!--
    @license
    Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
    This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
    The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
    The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
    Code distributed by Google as part of the polymer project is also
    subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/core-collapse/core-collapse.html">
<link rel="import" href="../components/marked-element/marked-element.html">

<polymer-element name="doc-section" attributes="data type">
  <template>
    <link rel="stylesheet" href="../css/elements/doc-section.css">
    <section class="box attribute-box">
      
      <h3 data-anchor-id="{{data.name}}.{{type}}">{{type | capitalize}}</h3>

      <template if="{{data.inherited[type].length}}">
        <button class="inherit-toggle" on-click="{{toggle}}">
          Show inherited
        </button>
      </template>

      <template if="{{data.inherited[type].length}}">
        <core-collapse id="collapse">
          <template repeat="{{parent in data.inherited[type]}}">
            <template repeat="{{entry in parent[type]}}">
              <div class="details details-collapsed" horizontal layout>
                <div class="details-name" flex>
                  <p><code data-anchor-id="{{data.name}}.{{type}}.{{entry.name}}">{{entry.name}}</code>
                  </p>
                </div>
                <div class="details-info" flex three>
                  <template if="{{entry.type}}">
                    <p layout horizontal center justified>
                      <code>&lt;<em>{{entry.type}}</em>&gt;</code><span class="default" hidden?="{{!entry.default}}">default: <code>{{entry.default}}</code></span>
                    </p>
                  </template>
                  <marked-element text="{{entry.description}}"></marked-element>
                  <template if="{{data[type].params.length}}">
                    <div class="params">
                      <p>{{type | singularize | capitalize}} details:</p>
                      <template repeat="{{param in event.params}}">
                        <p><code>&lt;<em>{{param.type}}</em>&gt; {{param.name}}</code>
                        </p>
                        <p><span>{{param.description}}</span>
                        </p>
                      </template>
                    </div>
                  </template>
                </div>
              </div>
            </template>
          </template>
        </core-collapse>
      </template>
      
      <template repeat="{{entry in data[type]}}">
        <div class="details" horizontal layout>
          <div class="details-name" flex>
            <p><code data-anchor-id="{{data.name}}.{{type}}.{{entry.name}}">{{entry.name}}</code>
            </p>
          </div>
          <div class="details-info" flex three>
            <template if="{{entry.type}}">
              <p layout horizontal center justified>
                <code>&lt;<em>{{entry.type}}</em>&gt;</code><span class="default" hidden?="{{!entry.default}}">default: <code>{{entry.default}}</code></span>
              </p>
            </template>
            <marked-element text="{{entry.description}}"></marked-element>
            <template if="{{data[type].params.length}}">
              <div class="params">
                <p>{{type | singularize | capitalize}} details:</p>
                <template repeat="{{param in event.params}}">
                  <p><code>&lt;<em>{{param.type}}</em>&gt; {{param.name}}</code>
                  </p>
                  <p><span>{{param.description}}</span>
                  </p>
                </template>
              </div>
            </template>
          </div>
        </div>
      </template>
    </section>
  </template>
  <script>
  Polymer('doc-section', {
    entries: [],
    capitalize: function(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);;
    },
    singularize: function(str) {
      return str.slice(0, str.length - 1);
    },
    toggle: function() {
      this.$.collapse.toggle();
    }
  });
  </script>
</polymer-element>
